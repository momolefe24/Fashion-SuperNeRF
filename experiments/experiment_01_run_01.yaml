---
# ------------------- Experiment Facts
experiment_facts:
 experiment_number: 1
 run_number: 1
 root_path: "./"
 story: "Pretraining the three models such that when we combine them together, and evaluate the input (shirt, pose, person), the output is a novel fashion-view"
 research_question: "Can we synthesize a novel view fashion try-on to recreate a smart mirror using AI, instead of AR"
 machine:
  computer: "laptop" # [laptop, rail, cluster]
  node: "big gpu" #[stampede, big gpu, batch]
  gpu: "GTX 3080" # [GTX 1060, RTX 2060, GTX 3080]
 type: "orginal_hrviton" # Branch name
 experiment_name: "Pretrained Virtual Try-On"
 experiment_description: "Train A Virtual Try-On Network to transfer garments on a person's torso."
 experiment_stragey: "Pretrain condition generator that learns to warp clothing. Then load the condition generator to train a network to synthesize a garment on a person's torso."
 experiment_insights: "Buttoned shirts perform badly as a result of collars, and they are harder to deform."
 tags: "Virtual Try-On, Densepose, Openpose, Human Parse Segmentation, Instance-Level Segmentation, SPADE, Image Inpainting"
 seed: 40 # The seed value makes the results reproducible
 device: 'cuda' # [cpu, cuda, cuda:0, cuda:1]


# ------------------- Checkpoint Facts
checkpoint_facts:
 root_path: "checkpoints"
 condition_generator:
  load_checkpoint: True
  load_checkpoint_step: 120000
  save_checkpoint: True
  generator: "tocg_step_%06d.pth"
  discriminator: "D_step_%06d.pth"
 VITON_generator:
  load_checkpoint: False
  save_checkpoint: True
  generator: "gen_step_%06d.pth"
  discriminator: "D_step_%06d.pth"


# ------------------- Result Facts
results_facts:
 experiment_number: 1
 run_number: 1
 root_path: "Results"
 condition_results:
  condition_path: "Results/Clothing_Warping"
 viton_results:
  generator_path: "Results/VITON"
 summary_facts:
  root_path: "Summary"
  tensorboard_count: 100
  display_count: 100
  condition_summary:
   weights_dir: "weights/Clothing_Warping"
   samples_dir: "samples/Clothing_Warping"
   writer_logs_dir: "log"
  generator_summary:
   weights_dir: "weights/VITON"
   samples_dir: "samples/VITON"
   writer_logs_dir: "log"

# ------------------- Dataset Facts
dataset_facts:
 person: "molefe"
 train_list: "train_pairs.txt"
 test_list: "test_pairs.txt"
 image_shape: (1024, 768)
 fine_width: 192
 fine_height: 256
 white_background: False
 use_viewdirs: True
 transforms:
  mean: (0, 0, 0)
  std: (1, 1, 1)


# ------------------- Hyperparameter Facts
hyperparameter_facts:
 batch_size: 8
 num_workers: 4
 epochs: 5000
 nerf_hyperparameters:
  random_samples: 1024
  near: 2.
  far: 6.
  num_samples: 64
  precrop_iters: 500
  precrop_factor: 0.5
  raw_predictions: True # retraw
  perturb: 1.0 # If non-zero, each ray is sampled at stratified random points in time.
  importance: 128
  raw_noise_std: 0
  num_chunks: 32 # chunk: 33024 # Maximum number of rays to process simultaneously. Used to control maximum memory usage
  factor: 8
 sr_hyperparameters:
 viton_hyperparameters:

# ------------------- Model Facts
model_facts:
 nerf_model:
  lrate: 0.0005
  lrate_decay: 500
  network_fine: True
  input_channel: 3
  input_channel_views: 3
  output_channel: 5
  skips: 4
  netchunk: 65536
  netdepth: 8
  netdepth_fine: 8
  net_width: 256
  net_width_fine: 256
  perturb: 1.0
  precrop_frac: 0.5
 sr_model:
 viton_model:
